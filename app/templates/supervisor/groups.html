{% extends "layouts/dashboard.html" %}
{% set sidebar_subtitle = "Supervisor Portal" %}
{% block page_title %}Assigned Groups{% endblock %}

{% block sidebar %}
<a class="nav-link" href="{{ url_for('supervisor.dashboard') }}">
  <i class="bi bi-speedometer2 me-2"></i>Dashboard
</a>
<a class="nav-link active" href="{{ url_for('supervisor.groups') }}">
  <i class="bi bi-people me-2"></i>Assigned Groups
</a>
<a class="nav-link" href="{{ url_for('supervisor.activity_create') }}">
  <i class="bi bi-plus-circle me-2"></i>Create Activity
</a>
<a class="nav-link" href="{{ url_for('supervisor.reports') }}">
  <i class="bi bi-clipboard-data me-2"></i>Activity Report
</a>
<a class="nav-link" href="{{ url_for('supervisor.title_approvals') }}">
  <i class="bi bi-check2-square me-2"></i>Title Approvals
</a>
{% endblock %}
{% block sidebar_mobile %}{{ self.sidebar() }}{% endblock %}

{% block content %}
<div class="bg-white rounded shadow p-4">
  <h4 class="mb-3">Assigned Groups</h4>

  <div class="table-responsive">
    <table class="table align-middle">
      <thead>
        <tr>
          <th>Group Code</th>
          <th>Members</th>
          <th>Approved Title</th>
        </tr>
      </thead>

      <tbody>
        {% for row in group_rows %}
        <tr>
          <td class="fw-bold">{{ row.assignment.group_code }}</td>

          <!-- MEMBERS -->
          <td>
            {% for s in row.members %}
              <div class="mb-2">
                <div class="fw-semibold">
                  {{ s.student_id }} â€“ {{ s.name }}
                </div>
                <div class="text-muted small">
                  ðŸ“ž {{ s.phone or "N/A" }} |
                  ðŸŽ“ {{ s.batch or "N/A" }}
                </div>
              </div>
            {% endfor %}
          </td>

          <!-- TITLE -->
          <td>
            {% if row.title %}
              <div class="fw-bold">{{ row.title.title }}</div>
              <div class="text-muted">{{ row.title.project_type }}</div>
            {% else %}
              <span class="badge bg-secondary">Not approved</span>
            {% endif %}
          </td>
        </tr>
        {% else %}
        <tr>
          <td colspan="3" class="text-muted text-center">
            No assigned groups yet.
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
